%%[

SET @firstname = RequestParameter('first-name')
SET @lastname = RequestParameter('last-name')
SET @email = RequestParameter('email')
SET @jobtitle = RequestParameter('job-title')
SET @country = RequestParameter('selectedCountryName') 
SET @activesubscription = RequestParameter('active-subscription')
SET @optin = RequestParameter('sub-opt-in')
SET @tcagree = RequestParameter('tc-agree')
SET @countrycode = RequestParameter('country')
SET @leadowner = '00528000001opmf'
SET @leadsource = 'Marketing Cloud'
SET @leadstatus = 'Market Prospect'
SET @description = CONCAT(' Active subscription:  ', @activesubscription)
SET @company = RequestParameter('school')
SET @trial = RequestParameter('trial')

IF empty(@optin) THEN
SET @updatemarketinginterest = ""
ELSE
SET @updatemarketinginterest = 'Promotions;Product information;'
ENDIF

IF empty(@trial) THEN
SET @company = 'Not Set - Gated content campaign lead'
ELSE
SET @leadstatus = 'New'
SET @enquirytype = 'Class Trial'
SET @description = 'Lead downloaded the PSR lesson planner resource and has requested a trial'
ENDIF


 SET @Id = CreateSalesforceObject('lead',
           15,  /* Number of fields specified to add in the Lead record */ 
           "Title", @jobTitle,
           "Product_Interest__c", 'Mathletics',
           "FirstName", @firstName,
           "LastName", @lastName,   
           "Email", @email,
           "Company", @company,
           "Country__c", @country,
           "CountryCode", @countryCode,
         "Marketing_Product_Interest__c", 'Mathletics', 
         "Marketing_Interest__c",@updatemarketinginterest,
           "OwnerID", @leadowner,
           "LeadSource", @leadsource,
           "Status", @leadstatus,
           "Description", @description,
           "Enquiry_Type__c", @enquirytype
          )  

SET @campaignMemberId = CreateSalesforceObject('CampaignMember', 3, 'CampaignId', '7010I000001e3BP', 'LeadId', @Id,'Status','Sent')

IF @leadId == '' THEN

Redirect('https://cloud.mc1.3plearning.com/ohno')

ELSE
Redirect('https://www.mathletics.com/problem-solving-reasoning-lesson-plan/thanks')

ENDIF

]%%