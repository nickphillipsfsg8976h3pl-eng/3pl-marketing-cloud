%%[
SET @ccode = RequestParameter('countryCode')
SET @stringifyData = "["

SET @numRowsToReturn = 10000
 
SET @StateRowSet = LookupOrderedRows("State",@numRowsToReturn, "State Code ASC","Country Code",@ccode,"Active",1)
 
IF RowCount(@StateRowSet) == 0 THEN
 SET @stringifyData = Concat(
  @stringifyData,
  '{"countryCode":"','n/a',
  '","stateCode":"','n/a',
  '","stateName":"','n/a',
  '"}]')
ELSE
 FOR @i = 1 to RowCount(@StateRowSet) DO

 SET @CountryCode = Field(Row(@StateRowSet, @i), "Country Code")
 SET @StateCode = Field(Row(@StateRowSet, @i), "State Code")
 SET @StateName = Field(Row(@StateRowSet, @i), "State Name")

 IF Length(@stringifyData) == 1 THEN 
  SET @stringifyData = Concat(
   @stringifyData,
   '{"countryCode":"',@CountryCode,
   '","stateCode":"',@StateCode,
   '","stateName":"',@StateName,
   '"}') 
 ELSE
  SET @stringifyData = Concat(
  @stringifyData,
   ',{"countryCode":"',@CountryCode,
   '","stateCode":"',@StateCode,
   '","stateName":"',@StateName,
   '"}')  
 ENDIF
 NEXT @i
 SET @stringifyData = Concat(@stringifyData,']')

ENDIF
]%%

<rs1>%%=v(@stringifyData)=%%</rs1>