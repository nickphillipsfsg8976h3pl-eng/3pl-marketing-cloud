<!--
//
//
//
-->

<h2>query a data extension of list</h2>

<!-- search form -->
<form action="%%=CloudPagesUrl(6477, 'submitted', 'true')=%%" method="post">
    <input type="text" name="DATA_EXTENSION_OR_LIST_NAME" />
    <input type="text" lable="Where Field Name" name="WHERE_FIELD_NAMES" />
    <input type="text" lable="Equals Field Value" name="WHERE_VALUE_VALUES" />
</form>

<!-- submit query -->
<script runAt="server">
    Platform.Load('core', '1');

    var data, json, errorMessage;

    try {
        var submitted = Request.GetQueryStringParameter('submitted');

        if (submitted) {
            var DATA_EXTENSION_OR_LIST_NAME = Request.GetQueryStringParameter(
                'DATA_EXTENSION_OR_LIST_NAME'
            );
            var WHERE_FIELD_NAMES = Request.GetQueryStringParameter('WHERE_FIELD_NAMES');
            var WHERE_VALUE_VALUES = Request.GetQueryStringParameter('WHERE_VALUE_VALUES');

            var testDE = DataExtension.Init(DATA_EXTENSION_OR_LIST_NAME);
            data = testDE.Rows.Lookup([WHERE_FIELD_NAMES], [WHERE_FIELD_NAMES]);
            json = Stringify(data);
        }
    } catch (e) {
        errorMessage = e.message;
    }
</script>

<!-- print results -->
<ctrl:var name="json" />
<ctrl:var name="errorMessage" />
