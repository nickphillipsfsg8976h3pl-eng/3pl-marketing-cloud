%%[
  
  /* Const for Salesforce Lead */
  SET @LeadSource = RequestParameter("utm_source")
  SET @LeadStatus = "MQL"
  SET @LeadTerritory = "APAC"
  SET @LeadCustomerLeadTypeId = "0120I0000019a2jQAA"
   

  SET @RedirectId = RequestParameter('rid')


  /* Get all form fields value */
  SET @firstName = TRIM(RequestParameter("first-name"))
  SET @lastName = TRIM(RequestParameter("last-name"))
  SET @email = TRIM(RequestParameter("email"))
  SET @phone = TRIM(RequestParameter("phone"))
  SET @jobTitle = RequestParameter("job-title")
  SET @countryCode = RequestParameter("country")
  SET @countryName = RequestParameter("selectedCountryName")
  SET @stateCode = RequestParameter("state")
 SET @Product = RequestParameter("Product")
 SET @utm_source = RequestParameter("utm_source")
 SET @Campaign = RequestParameter("Campaign")
  SET @stateName = RequestParameter("selectedStateName")
  

  SET @schoolEnquiryQuestionId = RequestParameter("enquiry-select-school-user")
  SET @homeEnquiryQuestionId = RequestParameter("enquiry-select-home-user")

  SET @isTermAgree = RequestParameter("tc-agree")
  SET @isReceiveEmail = RequestParameter("sub-opt-in")
 SET @productCode = "Mathletics"
SET @enquiry = 'Information'
  SET @resource = RequestParameter("resource")
SET @Description = Concat('Customer has requested a quote for ', @license, ' license')

  IF @isTermAgree == "agree" THEN
    SET @isTermAgree = "true"
  ELSE 
    SET @isTermAgree = "false"
  ENDIF
 
IF @isReceiveEmail == "receive" THEN
    SET @isReceiveEmail = "true"
  ELSE 
    SET @isReceiveEmail = "false"
  ENDIF
  


   SET @updatemarketinginterest = 'Promotions;Product information;'


IF @isReceiveEmail == 'true' THEN
 SET @updatemarketinginterest = CONCAT(@updatemarketinginterest, 'Newsletter;')
ENDIF
  
  /* create Lead in Salesforce */
   
    SET @leadId = CreateSalesforceObject("Lead",
           17,  /* Number of fields specified to add in the Lead record */ 

           "LeadSource", @LeadSource, 
           "Status", @LeadStatus,
    "Enquiry_Type__c", @enquiry,
           "RecordTypeId", @LeadCustomerLeadTypeId,
           "Territory__c", @LeadTerritory, 
           "Marketing_Product_Interest__c", 'Mathletics',
    "Marketing_Interest__c",@updatemarketinginterest,
           "FirstName", @firstName,
           "LastName", @lastName,
           "Company", "Marketing Lead",
           "Phone", @phone,
        "Title", @jobTitle,
           "Email", @email,
           "Description", @Description,
           "Country__c", @countryName,
           "CountryCode", @countryCode,
           "Product_Interest__c", @Product )


set @campaignMemberId = CreateSalesforceObject('CampaignMember', 3, 'CampaignId', @Campaign, 'LeadId', @leadId,'Status','Sent')
 
SET @redirectURL = Lookup('TOF - URL Redirect','URL','Id',@RedirectId)

IF @leadId == '' THEN
Redirect('https://cloud.my.3plearning.com/trialerror')

ELSE
Redirect(@redirectURL)

ENDIF

]%%

