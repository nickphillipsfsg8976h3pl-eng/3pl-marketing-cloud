<script runat="server">

    Platform.Load("core", "1");

    var api = new Script.Util.WSProxy();

    var restInstanceUrl = "https://mc7njyylzk4cy7fxs41hcz66ylr1.rest.marketingcloudapis.com",
        accessToken     = "eyJhbGciOiJIUzI1NiIsImtpZCI6IjQiLCJ2ZXIiOiIxIiwidHlwIjoiSldUIn0.eyJhY2Nlc3NfdG9rZW4iOiI3YWRzT2JDSVExMzNkWHROQzBGcW1HM2EiLCJjbGllbnRfaWQiOiJseWVvc211OXl4cndzd3ZkYjVyeDN1OWsiLCJlaWQiOjcyOTY4MDYsInN0YWNrX2tleSI6IlM3IiwicGxhdGZvcm1fdmVyc2lvbiI6MiwiY2xpZW50X3R5cGUiOiJTZXJ2ZXJUb1NlcnZlciIsInBpZCI6MjcxfQ.JCE0qtPv1rHYiHohvd8YGVLZlNoAYg7y2w6WyBf4NF4.w26G_V-yt5_dYNoyzUtX65F06vchanJ4kC661pCr0bzj9fRdiYu8NPhwqwnmpIeae7jWY7SyQ1j7DWww9-EPMY8eT9hW-WIGuLb_sL9okeumH1rX1G0HMLKbYnseizwWYXl6yFSvQ4JW0Kv-s5KZknuAidiHN1whFh8lu5fm5";
 
 try {

        var payload = {
            "page": {
                "pageSize": 300,
                "page": 1
            },
            "query": {
                "property": "assetType.id",
                "simpleOperator": "in",
                "values": [240, 241, 242, 243, 244, 245, 247, 248, 249]
            },
            "fields": [
                "id",
                "customerKey",
                "objectID",
                "assetType",
                "name",
                "owner",
                "content",
                "createdDate",
                "createdBy",
                "modifiedDate",
                "modifiedBy",
                "thumbnail",
                "category",
                "meta"
            ],
            "sort": [
                {
                    "property": "modifiedDate",
                    "direction": "DESC"
                }
            ]
        }

        var endpoint = restInstanceUrl + "asset/v1/content/assets/query";

        var request = new Script.Util.HttpRequest(endpoint);
            request.emptyContentHandling = 0;
            request.retries = 2;
            request.continueOnError = true;
            request.setHeader("Authorization", "Bearer " + accessToken);
            request.method = "POST";
            request.contentType = "application/json";
            request.postData = Stringify(payload);

        var results = request.send();

        var result = Platform.Function.ParseJSON(String(results.content));

        Write(Stringify(result));
  
 } catch(error) {

        Write(Stringify(error));
        
    } 

</script>